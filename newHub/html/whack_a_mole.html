<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Whack-a-Mole</title>
  <style>
    :root{--bg:#071021;--accent:#ff4fcc;--muted:rgba(255,255,255,0.85)}
    html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Roboto,Arial;color:var(--muted);background:linear-gradient(180deg,#071021,#0f1a2b);}
    .container{max-width:980px;margin:18px auto;padding:12px}
    header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
    a.back{color:#fff;text-decoration:none;padding:8px 12px;border-radius:8px;background:rgba(255,255,255,0.03)}
    .board{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;background:rgba(255,255,255,0.02);padding:18px;border-radius:12px}
    .hole{background:rgba(0,0,0,0.25);height:120px;border-radius:12px;position:relative;overflow:hidden;display:flex;align-items:flex-end;justify-content:center;cursor:pointer}
    .mole{width:76px;height:76px;border-radius:50%;background:#ffcf8a;display:flex;align-items:center;justify-content:center;transform:translateY(100%);transition:transform .18s ease}
    .mole.up{transform:translateY(0%)}
    .hud{display:flex;gap:12px;align-items:center;margin:12px 0}
    .stat{background:rgba(255,255,255,0.03);padding:8px 12px;border-radius:8px}
    .center{display:flex;align-items:center;justify-content:center}
    button{background:var(--accent);color:#071021;border:0;padding:8px 12px;border-radius:8px;cursor:pointer}
    .note{font-size:0.9rem;color:rgba(255,255,255,0.7)}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <a class="back" href="../index.html">← Retour au Hub</a>
      <div>
        <h2 style="margin:0">Whack-a-Mole</h2>
        <div class="note">Cliquez sur les taupes qui apparaissent pour marquer des points — 30 secondes.</div>
      </div>
    </header>

    <div class="hud">
      <div class="stat">Score: <strong id="score">0</strong></div>
      <div class="stat">Temps: <strong id="time">30</strong>s</div>
      <div style="margin-left:auto" class="center"><button id="start">Démarrer</button></div>
    </div>

    <div class="board" id="board" aria-live="polite">
      <!-- 9 holes -->
      <div class="hole" data-index="0"><div class="mole" data-index="0"></div></div>
      <div class="hole" data-index="1"><div class="mole" data-index="1"></div></div>
      <div class="hole" data-index="2"><div class="mole" data-index="2"></div></div>
      <div class="hole" data-index="3"><div class="mole" data-index="3"></div></div>
      <div class="hole" data-index="4"><div class="mole" data-index="4"></div></div>
      <div class="hole" data-index="5"><div class="mole" data-index="5"></div></div>
      <div class="hole" data-index="6"><div class="mole" data-index="6"></div></div>
      <div class="hole" data-index="7"><div class="mole" data-index="7"></div></div>
      <div class="hole" data-index="8"><div class="mole" data-index="8"></div></div>
    </div>

    <div style="margin-top:12px" class="note">Astuce: cliquez rapidement et évitez de cliquer sur des trous vides — clics ratés n'enlèvent pas de points.</div>
  </div>

  <script>
  (function(){
    const holes = Array.from(document.querySelectorAll('.hole'));
    const moles = holes.map(h => h.querySelector('.mole'));
    const scoreEl = document.getElementById('score');
    const timeEl = document.getElementById('time');
    const startBtn = document.getElementById('start');

    let score = 0, timeLeft = 30, timerId = null, moleTimer = null, running = false;

    function rand(min, max){ return Math.floor(Math.random() * (max - min + 1)) + min; }

    function popUp(){
      const idx = rand(0, moles.length - 1);
      const mole = moles[idx];
      mole.classList.add('up');
      const upTime = rand(600, 1100);
      setTimeout(()=>{ mole.classList.remove('up'); }, upTime);
    }

    function start(){
      if(running) return;
      running = true; score = 0; timeLeft = 30; updateHUD();
      timerId = setInterval(()=>{
        timeLeft--; updateHUD();
        if(timeLeft <= 0){ stop(); }
      }, 1000);
      moleTimer = setInterval(popUp, 700);
    }

    function stop(){
      running = false;
      clearInterval(timerId); clearInterval(moleTimer);
      // ensure all moles down
      moles.forEach(m=>m.classList.remove('up'));
      alert('Temps écoulé ! Score: ' + score);
    }

    function updateHUD(){ scoreEl.textContent = score; timeEl.textContent = timeLeft; }

    // click handling
    holes.forEach((h, i)=>{
      h.addEventListener('click', (e)=>{
        const mole = moles[i];
        if(!running) return;
        if(mole.classList.contains('up')){
          // whacked
          score += 1; mole.classList.remove('up'); updateHUD();
        }
      });
    });

    startBtn.addEventListener('click', ()=>{
      if(running){ stop(); start(); } else start();
    });
  })();
  </script>
</body>
</html>
