<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>2048 Neon Edition</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <style>
        :root{
            --bg-1: #071021;
            --bg-2: #0f1a2b;
            --neon-pink: #ff4fcc;
            --neon-cyan: #19f0ff;
            --neon-green: #7cff7c;
            --muted: rgba(255,255,255,0.75);
            --glass: rgba(255,255,255,0.04);
        }
        body {
            background: linear-gradient(180deg,var(--bg-1), var(--bg-2));
            color: var(--muted);
            font-family: Inter, 'Segoe UI', Roboto, Arial, sans-serif;
            min-height:100vh;
            margin:0;
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
        }
        h1 {
            color: #fff;
            text-shadow: 0 0 12px var(--neon-pink), 0 0 24px var(--neon-cyan);
            margin-bottom: 8px;
        }
        .subtitle {
            color: var(--neon-cyan);
            margin-bottom: 24px;
            font-size: 1.1rem;
            text-shadow: 0 0 8px var(--neon-cyan);
        }
        .board {
            background: var(--glass);
            border-radius: 18px;
            box-shadow: 0 0 32px var(--neon-cyan), 0 0 12px var(--neon-pink);
            padding: 24px;
            display: grid;
            grid-template-columns: repeat(4, 64px);
            grid-template-rows: repeat(4, 64px);
            gap: 12px;
            margin-bottom: 18px;
        }
        .tile {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 12px;
            background: var(--glass);
            box-shadow: 0 0 8px var(--neon-green);
            color: #fff;
            transition: background .2s, color .2s;
        }
        .tile[data-v="2"]    { background: linear-gradient(135deg, var(--neon-cyan), var(--glass)); color: #fff;}
        .tile[data-v="4"]    { background: linear-gradient(135deg, var(--neon-pink), var(--glass)); color: #fff;}
        .tile[data-v="8"]    { background: linear-gradient(135deg, var(--neon-green), var(--glass)); color: #fff;}
        .tile[data-v="16"]   { background: linear-gradient(135deg, #ffb347, var(--glass)); color: #fff;}
        .tile[data-v="32"]   { background: linear-gradient(135deg, #ff4fcc, #19f0ff); color: #fff;}
        .tile[data-v="64"]   { background: linear-gradient(135deg, #7cff7c, #ff4fcc); color: #fff;}
        .tile[data-v="128"]  { background: linear-gradient(135deg, #19f0ff, #ffb347); color: #fff;}
        .tile[data-v="256"]  { background: linear-gradient(135deg, #ff4fcc, #7cff7c); color: #fff;}
        .tile[data-v="512"]  { background: linear-gradient(135deg, #ffb347, #19f0ff); color: #fff;}
        .tile[data-v="1024"] { background: linear-gradient(135deg, #7cff7c, #ffb347); color: #fff;}
        .tile[data-v="2048"] { background: linear-gradient(135deg, #fff, #ff4fcc); color: var(--neon-pink); text-shadow: 0 0 8px var(--neon-pink);}
        .score {
            font-size: 1.1rem;
            color: var(--neon-green);
            margin-bottom: 12px;
            text-shadow: 0 0 8px var(--neon-green);
        }
        .btn {
            background: var(--neon-pink);
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 8px 18px;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 0 8px var(--neon-pink);
            margin-bottom: 18px;
        }
        .btn:hover {
            background: var(--neon-cyan);
            box-shadow: 0 0 12px var(--neon-cyan);
        }
        .footer {
            color: rgba(255,255,255,0.45);
            font-size: 0.95rem;
            margin-top: 24px;
            text-align: center;
        }
        .footer a {
            display: inline-block;
            padding: 8px 18px;
            border-radius: 8px;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-pink));
            color: #fff !important;
            text-decoration: none;
            font-weight: bold;
            box-shadow: 0 0 12px var(--neon-cyan), 0 0 12px var(--neon-pink);
            transition: background 0.2s, box-shadow 0.2s;
        }
        .footer a:hover {
            background: linear-gradient(90deg, var(--neon-pink), var(--neon-cyan));
            box-shadow: 0 0 24px var(--neon-pink), 0 0 24px var(--neon-cyan);
        }
    </style>
</head>
<body>
    <h1>üß© 2048 Neon Edition</h1>
    <div class="subtitle">Combine les blocs pour atteindre <b>2048</b> ! Utilise les <b>fl√®ches</b> du clavier.</div>
    <div class="score" id="score">Score: 0</div>
    <div class="score" id="bestScore">Meilleur score: 0</div>
    <button class="btn" onclick="restart()">Recommencer</button>
    <div class="board" id="board"></div>
    <div class="footer">
        <a href="../index.html" style="color:var(--neon-cyan);text-decoration:none;">‚Üê Retour au Hub</a>
    </div>
    <script>
        // 2048 logic
        const board = document.getElementById('board');
        const scoreEl = document.getElementById('score');
        const bestScoreEl = document.getElementById('bestScore');
        let grid, score;
        let bestScore = Number(localStorage.getItem('neon2048_best')) || 0;

        function updateBestScore() {
            if (score > bestScore) {
                bestScore = score;
                localStorage.setItem('neon2048_best', bestScore);
            }
            bestScoreEl.textContent = 'Meilleur score: ' + bestScore;
        }

        function restart() {
            grid = Array(4).fill().map(()=>Array(4).fill(0));
            score = 0;
            addTile(); addTile();
            render();
            updateBestScore();
        }

        function addTile() {
            let empty = [];
            for(let r=0;r<4;r++) for(let c=0;c<4;c++)
                if(grid[r][c]===0) empty.push([r,c]);
            if(empty.length){
                const [r,c] = empty[Math.floor(Math.random()*empty.length)];
                grid[r][c] = Math.random()<0.9 ? 2 : 4;
            }
        }

        function render() {
            board.innerHTML = '';
            for(let r=0;r<4;r++) for(let c=0;c<4;c++){
                const v = grid[r][c];
                const tile = document.createElement('div');
                tile.className = 'tile';
                tile.setAttribute('data-v', v);
                tile.textContent = v>0?v:'';
                board.appendChild(tile);
            }
            scoreEl.textContent = 'Score: ' + score;
            updateBestScore();
        }

        function move(dir) {
            let moved = false;
            let merged = Array(4).fill().map(()=>Array(4).fill(false));
            function traverse(fn){
                for(let r=0;r<4;r++) for(let c=0;c<4;c++) fn(r,c);
            }
            function slideRow(row){
                let arr = grid[row].filter(v=>v);
                for(let i=0;i<arr.length-1;i++){
                    if(arr[i]===arr[i+1] && !merged[row][i] && !merged[row][i+1]){
                        arr[i]*=2; score+=arr[i]; arr[i+1]=0; merged[row][i]=true;
                    }
                }
                arr = arr.filter(v=>v);
                while(arr.length<4) arr.push(0);
                for(let c=0;c<4;c++) if(grid[row][c]!==arr[c]){grid[row][c]=arr[c];moved=true;}
            }
            function slideCol(col){
                let arr = [];
                for(let r=0;r<4;r++) arr.push(grid[r][col]);
                for(let i=0;i<arr.length-1;i++){
                    if(arr[i]===arr[i+1] && !merged[i][col] && !merged[i+1][col]){
                        arr[i]*=2; score+=arr[i]; arr[i+1]=0; merged[i][col]=true;
                    }
                }
                arr = arr.filter(v=>v);
                while(arr.length<4) arr.push(0);
                for(let r=0;r<4;r++) if(grid[r][col]!==arr[r]){grid[r][col]=arr[r];moved=true;}
            }
            if(dir==='ArrowLeft'){
                for(let r=0;r<4;r++) slideRow(r);
            } else if(dir==='ArrowRight'){
                for(let r=0;r<4;r++){ grid[r].reverse(); slideRow(r); grid[r].reverse(); }
            } else if(dir==='ArrowUp'){
                for(let c=0;c<4;c++) slideCol(c);
            } else if(dir==='ArrowDown'){
                for(let c=0;c<4;c++){
                    let col = [];
                    for(let r=0;r<4;r++) col.push(grid[r][c]);
                    col.reverse();
                    for(let r=0;r<4;r++) grid[r][c]=col[r];
                    slideCol(c);
                    col = [];
                    for(let r=0;r<4;r++) col.push(grid[r][c]);
                    col.reverse();
                    for(let r=0;r<4;r++) grid[r][c]=col[r];
                }
            }
            if(moved) addTile();
            render();
            if(isGameOver()) setTimeout(()=>{
                updateBestScore();
                alert('Partie termin√©e! Score: '+score);
            },100);
        }

        function isGameOver(){
            for(let r=0;r<4;r++) for(let c=0;c<4;c++){
                if(grid[r][c]===0) return false;
                if(r<3 && grid[r][c]===grid[r+1][c]) return false;
                if(c<3 && grid[r][c]===grid[r][c+1]) return false;
            }
            return true;
        }

        window.addEventListener('keydown', e=>{
            if(['ArrowLeft','ArrowRight','ArrowUp','ArrowDown'].includes(e.key)){
                e.preventDefault();
                move(e.key);
            }
        });

        restart();
    </script>
</body>
</html>
