<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D√©mineur</title>
    <link rel="stylesheet" href="style.css">
    <style>
        :root {
  --bg: #0b1020;
  --card: #0f1724;
  --accent: #59d3c5;
  --muted: #95a3b8;
}
body {
  font-family: Inter, Arial, sans-serif;
  background: linear-gradient(180deg, #071021 0%, #071527 60%);
  color: #e6f0f4;
  text-align: center;
  min-height: 100vh;
  margin: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 24px;
}
header {
  width: 100%;
  padding: 24px 0 12px 0;
  background: linear-gradient(180deg, #172433 0%, #0f1b2a 100%);
  box-shadow: 0 6px 18px rgba(2,8,20,0.18);
  border-radius: 0 0 18px 18px;
  position: sticky;
  top: 0;
  z-index: 10;
}
header h1 {
  margin: 0;
  font-size: 2.2rem;
  color: var(--accent);
  text-shadow: 0 2px 12px #071021;
  letter-spacing: 1px;
}
#info-bar {
  margin: 20px auto;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 20px;
  font-size: 18px;
  background: var(--card);
  border-radius: 14px;
  box-shadow: 0 6px 20px rgba(2,8,20,0.12);
  padding: 12px 20px;
  font-weight: 600;
  color: var(--accent);
}
#game {
  display: inline-block;
  margin: 24px auto;
  border: 2.5px solid var(--accent);
  background: #0f1724;
  box-shadow: 0 10px 32px rgba(2,8,20,0.18);
  border-radius: 20px;
  padding: 20px 14px 14px 14px;
  transition: transform 0.2s, box-shadow 0.3s;
}
#game:hover { transform: scale(1.01); }
.cell {
  width: 36px;
  height: 36px;
  display: inline-block;
  border-radius: 8px;
  border: 1.5px solid #59d3c5;
  margin: 4px;
  vertical-align: top;
  font-size: 20px;
  line-height: 36px;
  cursor: pointer;
  user-select: none;
  background: linear-gradient(145deg, #172433, #0f1b2a);
  font-weight: 700;
  text-align: center;
  box-shadow: 0 4px 12px rgba(2,8,20,0.10);
  transition: transform 0.2s, background 0.3s, box-shadow 0.3s;
  color: #fff;
}
.cell:hover:not(.revealed):not(.flagged) {
  transform: scale(1.1);
  background: #59d3c5;
  box-shadow: 0 6px 20px rgba(89,211,197,0.18);
  color: #071021;
}
.cell.revealed { background: #59d3c5; color: #071021; cursor: default; }
.cell.mine { background: #ff6666; }
.cell.flagged { background: #ffe680; color: #fbc02d; }
#status {
  margin: 18px;
  font-size: 22px;
  font-weight: bold;
  border-radius: 12px;
  padding: 12px 0;
  min-height: 32px;
  background: var(--card);
  box-shadow: 0 4px 16px rgba(2,8,20,0.12);
  color: var(--accent);
}
#status.win { background: #d0ffd0; color: #2e8b57; }
#status.lose { background: #ffd0d0; color: #c00; }
button {
  padding: 10px 18px;
  font-size: 17px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  background: linear-gradient(180deg, #172433, #0f1b2a);
  color: #dff7f2;
  box-shadow: 0 4px 16px rgba(2,8,20,0.18);
  transition: background 0.2s, transform 0.2s;
  font-weight: bold;
}
button:hover {
  background: linear-gradient(180deg, #59d3c5, #0f1b2a);
  color: #fff;
  transform: scale(1.05);
}
/* Ajout du style pour le dropdown des difficult√©s */
select#difficulty {
  padding: 8px 14px;
  border-radius: 8px;
  border: 1.5px solid var(--accent);
  background: linear-gradient(180deg, #172433, #0f1b2a);
  color: var(--accent);
  font-size: 16px;
  font-weight: 600;
  box-shadow: 0 2px 8px rgba(2,8,20,0.10);
  margin-left: 8px;
  transition: border-color 0.2s, background 0.2s;
  outline: none;
  cursor: pointer;
}
select#difficulty:focus {
  border-color: #19f0ff;
  background: linear-gradient(180deg, #59d3c5, #0f1b2a);
  color: #fff;
}
select#difficulty option {
  background: #0f1b2a;
  color: var(--accent);
  font-weight: 600;
}
@media (max-width:700px){
  body {padding:8px;}
  #game{padding:8px;}
  header h1{font-size:1.4rem;}
}
    </style>
</head>
<body>
    <header>
        <h1>üí£ D√©mineur</h1>
    </header>

    <main>
        <div id="info-bar">
            <span id="timer">‚è±Ô∏è 60s</span>
            <span id="flags">üö© 15</span>
            <span id="wins">üèÜ 0</span>
            <span id="losses">üíÄ 0</span>
            <button id="restart">Recommencer</button>
            <select id="difficulty">
                <option value="easy">Facile</option>
                <option value="medium" selected>Moyen</option>
                <option value="hard">Difficile</option>
                <option value="powerups">Bonus</option>
            </select>
        </div>

        <div id="status"></div>
        <div id="game"></div>

        <button onclick="voltarMenu()" style="margin-top:20px;">‚¨Ö Retour au Hub</button>
    </main>
    <script>
        function voltarMenu() { window.location.href = "../index.html"; }
        window.addEventListener('DOMContentLoaded', () => { setDifficulty('medium'); initGame(); });
        document.getElementById('restart').onclick = function() { setDifficulty(document.getElementById('difficulty').value); initGame(); };
        document.getElementById('difficulty').onchange = function() { setDifficulty(this.value); initGame(); };
    </script>
    <script>
        // ----- Configura√ß√£o padr√£o -----
let ROWS = 10;
let COLS = 10;
let MINES = 15;
let SPECIAL_MINES = 0;
let BONUS_CELLS = 0;
let POWERUPS = false;

let board = [];
let revealed = [];
let flagged = [];
let gameOver = false;
let timer = 0;
let timerMax = 60;
let timerInterval = null;
let wins = 0;
let losses = 0;
let firstClick = true;

// ----- Fun√ß√µes utilit√°rias -----
function updateTimerDisplay() {
    document.getElementById('timer').textContent = `‚è±Ô∏è ${timer}s`;
}

function resetTimer() {
    stopTimer();
    timer = timerMax;
    updateTimerDisplay();
}

function startTimer() {
    if (timerInterval) return;
    timerInterval = setInterval(() => {
        timer--;
        updateTimerDisplay();
        if (timer <= 0) {
            stopTimer();
            if (!gameOver) loseGame("Temps √©coul√© !");
        }
    }, 1000);
}

function stopTimer() {
    if (timerInterval) clearInterval(timerInterval);
    timerInterval = null;
}

function updateFlags() {
    let flagsUsed = 0;
    for (let r = 0; r < ROWS; r++)
        for (let c = 0; c < COLS; c++)
            if (flagged[r] && flagged[r][c]) flagsUsed++;
    const remaining = Math.max(0, MINES + (POWERUPS ? SPECIAL_MINES : 0) - flagsUsed);
    document.getElementById('flags').textContent = `üö© ${remaining}`;
}

function updateWinsLosses() {
    document.getElementById('wins').textContent = `üèÜ ${wins}`;
    document.getElementById('losses').textContent = `üíÄ ${losses}`;
}

// ----- Inicializa√ß√£o do tabuleiro -----
function initGameArrays() {
    board = Array.from({ length: ROWS }, () => Array(COLS).fill(0));
    revealed = Array.from({ length: ROWS }, () => Array(COLS).fill(false));
    flagged = Array.from({ length: ROWS }, () => Array(COLS).fill(false));
}

// ----- Coloca√ß√£o de minas -----
function placeMines(safeR = null, safeC = null) {
    let minesPlaced = 0;
    let specialsPlaced = 0;
    let bonusPlaced = 0;

    while (minesPlaced < MINES) {
        let r = Math.floor(Math.random() * ROWS);
        let c = Math.floor(Math.random() * COLS);
        if (board[r][c] === 0 && !(r === safeR && c === safeC)) {
            board[r][c] = 'M';
            minesPlaced++;
        }
    }

    if (POWERUPS && SPECIAL_MINES > 0) {
        while (specialsPlaced < SPECIAL_MINES) {
            let r = Math.floor(Math.random() * ROWS);
            let c = Math.floor(Math.random() * COLS);
            if (board[r][c] === 0 && !(r === safeR && c === safeC)) {
                board[r][c] = 'S';
                specialsPlaced++;
            }
        }
        while (bonusPlaced < BONUS_CELLS) {
            let r = Math.floor(Math.random() * ROWS);
            let c = Math.floor(Math.random() * COLS);
            if (board[r][c] === 0 && !(r === safeR && c === safeC)) {
                board[r][c] = 'B';
                bonusPlaced++;
            }
        }
    }
}

// ----- C√°lculo dos n√∫meros adjacentes -----
function calculateNumbers() {
    for (let r = 0; r < ROWS; r++) {
        for (let c = 0; c < COLS; c++) {
            if (['M','S','B'].includes(board[r][c])) continue;
            let count = 0;
            for (let dr=-1; dr<=1; dr++) {
                for (let dc=-1; dc<=1; dc++) {
                    if (dr===0 && dc===0) continue;
                    let nr = r+dr, nc=c+dc;
                    if (nr>=0 && nr<ROWS && nc>=0 && nc<COLS) {
                        if (board[nr][nc]==='M' || board[nr][nc]==='S') count++;
                    }
                }
            }
            board[r][c] = count;
        }
    }
}

// ----- Renderiza√ß√£o do tabuleiro -----
function renderBoard() {
    const gameDiv = document.getElementById('game');
    gameDiv.innerHTML = '';
    for (let r=0; r<ROWS; r++) {
        const rowDiv = document.createElement('div');
        for (let c=0; c<COLS; c++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.dataset.row = r;
            cell.dataset.col = c;

            if (revealed[r][c]) {
                cell.classList.add('revealed');
                if (board[r][c]==='M') cell.textContent = 'üí£';
                else if (board[r][c]==='S') cell.textContent = 'üí•';
                else if (board[r][c]==='B') cell.textContent = '‚≠ê';
                else if (board[r][c]>0) cell.textContent = board[r][c];
            } else if (flagged[r][c]) {
                cell.classList.add('flagged');
                cell.textContent = 'üö©';
            }

            // clique direito para flag
            cell.oncontextmenu = (e)=>{
                e.preventDefault();
                if (gameOver || revealed[r][c]) return;
                flagged[r][c] = !flagged[r][c];
                updateFlags();
                renderBoard();
            };

            // clique esquerdo para revelar
            cell.onclick = ()=>{
                if (gameOver || flagged[r][c] || revealed[r][c]) return;
                if (firstClick) {
                    placeMines(r,c);
                    calculateNumbers();
                    resetTimer();
                    startTimer();
                    firstClick=false;
                }
                revealCascade(r,c);
                checkWin();
            };

            rowDiv.appendChild(cell);
        }
        gameDiv.appendChild(rowDiv);
    }
}

// ----- Revele c√©lulas recursivamente -----
function revealCascade(r,c) {
    if (r<0 || r>=ROWS || c<0 || c>=COLS || revealed[r][c] || flagged[r][c]) return;

    if (board[r][c]==='M' || board[r][c]==='S') {
        revealed[r][c] = true;
        loseGame(board[r][c]==='S' ? "Mine sp√©ciale ! üí•" : "Perdu ! üí£");
        return;
    }

    revealed[r][c] = true;

    if (board[r][c]===0) {
        for (let dr=-1; dr<=1; dr++)
            for (let dc=-1; dc<=1; dc++)
                if (dr!==0 || dc!==0) revealCascade(r+dr,c+dc);
    }
    renderBoard();
}

// ----- Perdeu -----
function loseGame(msg) {
    gameOver = true;
    losses++;
    updateWinsLosses();
    document.getElementById('status').textContent = msg;
    stopTimer();
    revealAllMines();
    renderBoard();
}

// ----- Revele todas as minas -----
function revealAllMines() {
    for (let r=0; r<ROWS; r++)
        for (let c=0; c<COLS; c++)
            if (board[r][c]==='M' || board[r][c]==='S') revealed[r][c]=true;
}

// ----- Checa vit√≥ria -----
function checkWin() {
    let total = 0;
    let revealedCount = 0;
    for (let r=0; r<ROWS; r++) {
        for (let c=0; c<COLS; c++) {
            if (board[r][c]!=='M' && board[r][c]!=='S') total++;
            if (revealed[r][c] && board[r][c]!=='M' && board[r][c]!=='S') revealedCount++;
        }
    }
    if (revealedCount===total) {
        gameOver = true;
        wins++;
        updateWinsLosses();
        document.getElementById('status').textContent = "Gagn√© ! üéâ";
        revealAllMines();
        renderBoard();
        stopTimer();
    }
}

// ----- Define dificuldade -----
function setDifficulty(level) {
    SPECIAL_MINES = 0;
    BONUS_CELLS = 0;
    POWERUPS = false;

    if (level==='easy') { ROWS=8; COLS=8; MINES=8; timerMax=60; }
    else if (level==='medium') { ROWS=10; COLS=10; MINES=15; timerMax=90; }
    else if (level==='hard') { ROWS=14; COLS=14; MINES=35; timerMax=150; }
    else if (level==='powerups') { ROWS=12; COLS=12; MINES=18; SPECIAL_MINES=4; BONUS_CELLS=6; POWERUPS=true; timerMax=120; }
}

// ----- Inicializa o jogo -----
function initGame() {
    initGameArrays();
    gameOver=false;
    firstClick=true;
    document.getElementById('status').textContent='';
    resetTimer();
    updateFlags();
    updateWinsLosses();
    renderBoard();
}

    </script>
</body>
</html>
